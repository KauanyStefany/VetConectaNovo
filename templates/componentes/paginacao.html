{#
  Componente de Paginação com Links Rotativos

  Parâmetros obrigatórios:
  - pagina: número da página atual
  - total_paginas: total de páginas disponíveis
  - url_base: URL base para os links (ex: '/artigos')

  Parâmetros opcionais:
  - params: dict com parâmetros adicionais para a URL (ex: {'categoria': 1})
#}

{% if total_paginas > 1 %}
<nav aria-label="Navegação de páginas">
    <ul class="pagination justify-content-center gap-2 mb-0">
        <!-- Botão Primeira Página -->
        <li class="page-item {% if pagina == 1 %}disabled{% endif %}">
            {% if pagina == 1 %}
                <span class="page-link" style="cursor: not-allowed;">
                    <i class="bi bi-chevron-bar-left"></i>
                </span>
            {% else %}
                <a class="page-link"
                   href="{{ url_base }}?pagina=1{% if params %}{% for key, value in params.items() %}&{{ key }}={{ value }}{% endfor %}{% endif %}"
                   aria-label="Primeira página">
                    <i class="bi bi-chevron-bar-left"></i>
                </a>
            {% endif %}
        </li>

        <!-- Botão Anterior -->
        <li class="page-item {% if pagina == 1 %}disabled{% endif %}">
            {% if pagina == 1 %}
                <span class="page-link" style="cursor: not-allowed;">
                    <i class="bi bi-chevron-left"></i>
                </span>
            {% else %}
                <a class="page-link"
                   href="{{ url_base }}?pagina={{ pagina - 1 }}{% if params %}{% for key, value in params.items() %}&{{ key }}={{ value }}{% endfor %}{% endif %}"
                   aria-label="Página anterior">
                    <i class="bi bi-chevron-left"></i>
                </a>
            {% endif %}
        </li>

        <!-- Links Numéricos Rotativos (2 anteriores + atual + 2 posteriores) -->
        {% set inicio = [1, pagina - 2]|max %}
        {% set fim = [total_paginas, pagina + 2]|min %}

        {# Ajustar para sempre mostrar 5 páginas quando possível #}
        {% if fim - inicio < 4 %}
            {% if pagina <= 3 %}
                {% set fim = [total_paginas, 5]|min %}
            {% elif pagina > total_paginas - 3 %}
                {% set inicio = [1, total_paginas - 4]|max %}
            {% endif %}
        {% endif %}

        {% for num in range(inicio, fim + 1) %}
            <li class="page-item {% if num == pagina %}active{% endif %}">
                {% if num == pagina %}
                    <span class="page-link bg-roxo border-roxo">{{ num }}</span>
                {% else %}
                    <a class="page-link"
                       href="{{ url_base }}?pagina={{ num }}{% if params %}{% for key, value in params.items() %}&{{ key }}={{ value }}{% endfor %}{% endif %}">
                        {{ num }}
                    </a>
                {% endif %}
            </li>
        {% endfor %}

        <!-- Botão Próxima -->
        <li class="page-item {% if pagina >= total_paginas %}disabled{% endif %}">
            {% if pagina >= total_paginas %}
                <span class="page-link" style="cursor: not-allowed;">
                    <i class="bi bi-chevron-right"></i>
                </span>
            {% else %}
                <a class="page-link"
                   href="{{ url_base }}?pagina={{ pagina + 1 }}{% if params %}{% for key, value in params.items() %}&{{ key }}={{ value }}{% endfor %}{% endif %}"
                   aria-label="Próxima página">
                    <i class="bi bi-chevron-right"></i>
                </a>
            {% endif %}
        </li>

        <!-- Botão Última Página -->
        <li class="page-item {% if pagina >= total_paginas %}disabled{% endif %}">
            {% if pagina >= total_paginas %}
                <span class="page-link" style="cursor: not-allowed;">
                    <i class="bi bi-chevron-bar-right"></i>
                </span>
            {% else %}
                <a class="page-link"
                   href="{{ url_base }}?pagina={{ total_paginas }}{% if params %}{% for key, value in params.items() %}&{{ key }}={{ value }}{% endfor %}{% endif %}"
                   aria-label="Última página">
                    <i class="bi bi-chevron-bar-right"></i>
                </a>
            {% endif %}
        </li>
    </ul>
</nav>

<style>
    .bg-roxo {
        background-color: var(--cor-roxo) !important;
        color: white !important;
    }

    .border-roxo {
        border-color: var(--cor-roxo) !important;
    }

    .page-link {
        color: var(--cor-roxo);
        border: 1px solid #dee2e6;
        padding: 0.5rem 0.75rem;
        border-radius: 0.375rem;
        transition: all 0.2s ease;
    }

    .page-link:hover {
        background-color: var(--cor-roxo);
        border-color: var(--cor-roxo);
        color: white;
    }

    .page-item.disabled .page-link {
        color: #6c757d;
        background-color: #f8f9fa;
        border-color: #dee2e6;
    }

    .page-item.active .page-link {
        z-index: 3;
        font-weight: 600;
    }

    .pagination {
        --bs-pagination-margin: 0;
    }
</style>
{% endif %}
